# Example CK3 Event File
# This file demonstrates various CK3 scripting patterns for testing trait validation and completions

namespace = example_events

# Trait Testing Event - Character becomes ambitious
example_events.0001 = {
	type = character_event
	title = example_events.0001.t
	desc = example_events.0001.desc
	theme = intrigue
	
	# Trigger checks for multiple traits
	trigger = {
		age >= 16
		is_ai = no
		NOT = { has_trait = ambitious }
		OR = {
			has_trait = diligent
			has_trait = greedy
			has_trait = arrogant
		}
	}
	
	# Weight based on traits
	weight_multiplier = {
		base = 100
		
		modifier = {
			add = 50
			has_trait = greedy
		}
		
		modifier = {
			add = 30
			has_trait = arrogant
		}
		
		modifier = {
			factor = 0.5
			has_trait = content
		}
	}
	
	# Gain ambitious trait
	option = {
		name = example_events.0001.a
		
		add_trait = ambitious
		add_prestige = 100
		
		stress_impact = {
			content = medium_stress_impact_gain
			humble = minor_stress_impact_gain
		}
	}
	
	# Stay content
	option = {
		name = example_events.0001.b
		trigger = {
			NOT = { has_trait = ambitious }
		}
		
		add_trait = content
		add_piety = 50
		
		stress_impact = {
			ambitious = medium_stress_impact_gain
			greedy = minor_stress_impact_gain
		}
	}
}

# Personality Trait Conflict Event
example_events.0002 = {
	type = character_event
	title = example_events.0002.t
	desc = example_events.0002.desc
	theme = mental_health
	
	trigger = {
		# Check for traits
		has_trait = brave
		# Note: brave and craven are opposites, so this trigger would never fire
		# Removed invalid craven check
	}
	
	immediate = {
		# Remove one conflicting trait
		if = {
			limit = { has_trait = craven }
			remove_trait = craven
		}
	}
	
	option = {
		name = example_events.0002.a
		add_trait = brave
	}
}

# Education Trait Event
example_events.0003 = {
	type = character_event
	title = example_events.0003.t
	desc = example_events.0003.desc
	theme = learning
	
	trigger = {
		age = 16
		is_adult = yes
		# Should have an education trait
		NOR = {
			has_trait = education_diplomacy_1
			has_trait = education_diplomacy_2
			has_trait = education_diplomacy_3
			has_trait = education_diplomacy_4
			has_trait = education_martial_1
			has_trait = education_stewardship_1
			has_trait = education_intrigue_1
			has_trait = education_learning_1
		}
	}
	
	option = {
		name = example_events.0003.a
		add_trait = education_diplomacy_3
	}
	
	option = {
		name = example_events.0003.b
		add_trait = education_martial_4
	}
	
	option = {
		name = example_events.0003.c
		add_trait = education_stewardship_2
	}
}

# Virtue and Sin Event
example_events.0004 = {
	type = character_event
	title = example_events.0004.t
	desc = example_events.0004.desc
	theme = faith
	
	trigger = {
		is_ruler = yes
		NOT = { has_trait = generous }
		gold >= 500
	}
	
	# Give to charity and gain virtue
	option = {
		name = example_events.0004.a
		
		add_trait = generous
		remove_short_term_gold = 500
		add_piety = 200
		
		# Check if already has opposite sin
		if = {
			limit = { has_trait = greedy }
			remove_trait = greedy
		}
		
		stress_impact = {
			greedy = major_stress_impact_gain
			callous = medium_stress_impact_gain
		}
	}
	
	# Keep the gold
	option = {
		name = example_events.0004.b
		
		add_trait = greedy
		add_gold = 100
		
		stress_impact = {
			generous = major_stress_impact_gain
			compassionate = medium_stress_impact_gain
		}
	}
}

# Health Trait Event
example_events.0005 = {
	type = character_event
	title = example_events.0005.t
	desc = example_events.0005.desc
	theme = healthcare
	
	trigger = {
		age >= 40
		NOT = {
			has_trait = ill
			has_trait = infirm
			has_trait = incapable
		}
	}
	
	immediate = {
		# Check current health status
		if = {
			limit = { has_trait = wounded_1 }
			add_trait = wounded_2
		}
	}
	
	# Become ill
	option = {
		name = example_events.0005.a
		
		add_trait = ill
		add_character_modifier = {
			modifier = bedridden
			months = 6
		}
	}
	
	# Age gracefully
	option = {
		name = example_events.0005.b
		trigger = {
			has_trait = healthy
		}
		
		add_trait = hale
		add_prestige = 50
	}
}

# Lifestyle Trait Event
example_events.0006 = {
	type = character_event
	title = example_events.0006.t
	desc = example_events.0006.desc
	theme = learning
	
	trigger = {
		is_adult = yes
		learning >= 12
		NOT = {
			has_trait = lifestyle_mystic
			has_trait = lifestyle_scholar
			has_trait = lifestyle_physician
		}
	}
	
	option = {
		name = example_events.0006.a
		add_trait = lifestyle_scholar
		add_learning_lifestyle_xp = 100
	}
	
	option = {
		name = example_events.0006.b
		add_trait = lifestyle_mystic
		add_piety = 100
	}
	
	option = {
		name = example_events.0006.c
		trigger = {
			learning >= 15
		}
		add_trait = lifestyle_physician
		add_learning_lifestyle_xp = 150
	}
}

# Complex Trait Check Event
example_events.0007 = {
	type = character_event
	title = example_events.0007.t
	desc = example_events.0007.desc
	theme = feast
	
	trigger = {
		# Multiple trait checks
		any_courtier = {
			has_trait = drunkard
			NOT = { has_relation_rival = root }
		}
		
		NOR = {
			has_trait = temperate
			has_trait = shy
		}
		
		OR = {
			has_trait = gregarious
			has_trait = gluttonous
			has_trait = reveler_1
		}
	}
	
	immediate = {
		# Find a drinking companion
		random_courtier = {
			limit = {
				has_trait = drunkard
				NOT = { has_relation_rival = root }
			}
			save_scope_as = drinking_buddy
		}
	}
	
	# Join the revelry
	option = {
		name = example_events.0007.a
		
		if = {
			limit = { NOT = { has_trait = drunkard } }
			add_trait = drunkard
		}
		
		if = {
			limit = { NOT = { has_trait = reveler_1 } }
			add_trait = reveler_1
		}
		
		scope:drinking_buddy = {
			add_opinion = {
				target = root
				modifier = friendship_opinion
			}
		}
		
		stress_impact = {
			temperate = major_stress_impact_gain
			shy = medium_stress_impact_gain
		}
	}
	
	# Decline politely
	option = {
		name = example_events.0007.b
		
		add_trait = temperate
		add_prestige = 25
		
		stress_impact = {
			gregarious = medium_stress_impact_gain
			gluttonous = minor_stress_impact_gain
		}
	}
}

# Commander Trait Event
example_events.0008 = {
	type = character_event
	title = example_events.0008.t
	desc = example_events.0008.desc
	theme = war
	
	trigger = {
		is_adult = yes
		martial >= 10
		NOT = {
			has_trait = lifestyle_blademaster
			has_trait = commander_1
		}
		is_at_war = yes
	}
	
	option = {
		name = example_events.0008.a
		add_trait = lifestyle_blademaster
		add_martial_lifestyle_xp = 200
	}
	
	option = {
		name = example_events.0008.b
		add_trait = commander_1
		add_prestige = 100
	}
}

# Congenital Trait Event (for children)
example_events.0009 = {
	type = character_event
	title = example_events.0009.t
	desc = example_events.0009.desc
	theme = childhood
	
	trigger = {
		age < 3
		is_alive = yes
		# Check parents for congenital traits
		OR = {
			father = { has_trait = intelligent }
			mother = { has_trait = intelligent }
		}
	}
	
	option = {
		name = example_events.0009.a
		add_trait = intelligent
		add_trait = genius
	}
	
	option = {
		name = example_events.0009.b
		add_trait = quick
	}
}

# Criminal Trait Event
example_events.0010 = {
	type = character_event
	title = example_events.0010.t
	desc = example_events.0010.desc
	theme = intrigue
	
	trigger = {
		intrigue >= 12
		NOT = {
			has_trait = murderer
			has_trait = kinslayer
			has_trait = deviant
		}
		intrigue >= 15
	}
	
	immediate = {
		random_scheme = {
			save_scope_as = murder_plot
		}
	}
	
	# Go through with it
	option = {
		name = example_events.0010.a
		
		add_trait = murderer
		
		# Check if target is family
		if = {
			limit = {
				OR = {
					is_parent_of = scope:murder_plot.scheme_target
					is_child_of = scope:murder_plot.scheme_target
					is_sibling_of = scope:murder_plot.scheme_target
				}
			}
			add_trait = kinslayer
		}
		
		stress_impact = {
			compassionate = massive_stress_impact_gain
			just = major_stress_impact_gain
		}
	}
	
	# Call it off
	option = {
		name = example_events.0010.b
		
		scope:murder_plot = {
			end_scheme = yes
		}
		
		add_trait = compassionate
		add_piety = 100
		
		stress_impact = {
			vengeful = medium_stress_impact_gain
			callous = minor_stress_impact_gain
		}
	}
}

# A decision example with trait requirements
example_decision = {
	picture = "gfx/interface/illustrations/decisions/decision_misc.dds"
	
	desc = example_decision_desc
	selection_tooltip = example_decision_tooltip
	
	is_shown = {
		is_ruler = yes
		has_government = feudal_government
		OR = {
			has_trait = ambitious
			has_trait = greedy
			has_trait = diligent
		}
	}
	
	is_valid = {
		gold >= 100
		prestige_level >= 2
		NOT = { has_trait = lazy }
	}
	
	effect = {
		remove_short_term_gold = 100
		
		# Give bonuses based on traits
		if = {
			limit = { has_trait = ambitious }
			add_prestige = 200
		}
		
		if = {
			limit = { has_trait = diligent }
			add_stewardship_lifestyle_xp = 100
		}
		
		every_vassal = {
			limit = {
				highest_held_title_tier = tier_duchy
				NOT = { has_trait = ambitious }
			}
			add_opinion = {
				target = root
				modifier = grateful_opinion
			}
		}
		
		add_character_modifier = {
			modifier = example_modifier
			years = 10
		}
	}
	
	ai_potential = {
		always = yes
	}
	
	ai_will_do = {
		base = 100
		
		modifier = {
			factor = 2.0
			has_trait = ambitious
		}
		
		modifier = {
			factor = 0.5
			gold < 200
		}
		
		modifier = {
			factor = 0
			has_trait = lazy
		}
	}
}
